<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />

        <script src="https://kit.fontawesome.com/b99e675b6e.js"></script>
        <script src="https://d3js.org/d3.v4.min.js"></script>

        <!--------------- CSS --------------->
        <link rel="stylesheet" href="assets/css/styles.css" />

        <title>GHG Emissions Visualization</title>
    </head>
    <body>
        <!--=============== HEADER ===============-->
        <header class="header" id="header">
            <!-- <nav class="nav container">
                <a href="#" class="nav__logo">GHG Emissions Visualization</a>
            </nav> -->
        </header>

        <main class="main">
            <!--=============== HOME ===============-->
            <section class="home section" id="home">
                <div class="home__container container grid">
                    <div class="home__data">
                        <h1 class="home__title">GHG Emissions Visualization</h1>
                    </div>
                    <div class="graphs_container">
                        <div class="map_container">
                            <div class="map_title">
                                <div class="titles">
                                    <h2>Annual GHG Emissions by Country</h2>
                                </div>
                                <div class="select-wrapper">
                                    <div class="select-dropdown-subject">
                                        <select class="" id="major">
                                            <option class="" value="">
                                                Worldwide
                                            </option>
                                        </select>
                                    </div>
                                </div>
                            </div>

                            <div class="map_card"></div>
                        </div>

                        <div class="scatter_container">
                            <div class="scatter_card">
                                <!-- <svg id="scatterplot"></svg> -->
                                <script type="text/javascript">
                                    var margin = {
                                        top: 20,
                                        right: 10,
                                        bottom: 20,
                                        left: 10,
                                    };
                                    var width =
                                        500 - margin.left - margin.right;
                                    var height =
                                        300 - margin.top - margin.bottom;

                                    var svg = d3
                                        .select(".scatter_card")
                                        .append("svg")
                                        .attr(
                                            "width",
                                            width + margin.left + margin.right
                                        )
                                        .attr(
                                            "height",
                                            height + margin.top + margin.bottom
                                        )
                                        .append("g")
                                        .attr(
                                            "transform",
                                            "translate(" +
                                                margin.left +
                                                "," +
                                                margin.top +
                                                ")"
                                        );

                                    // d3.csv('historical_emissions.csv')
                                    //   .then(function(data){
                                    //     console.log(data);
                                    //     console.log(data.columns);
                                    // })

                                    // fake data to populate the visualization to produce the framework
                                    d3.csv(
                                        "https://raw.githubusercontent.com/holtzy/data_to_viz/master/Example_dataset/5_OneCatSevNumOrdered_wide.csv",
                                        function (data) {
                                            console.log(data);
                                            console.log(data.columns);

                                            var keys = data.columns.slice(1);

                                            //add x axis
                                            var x = d3
                                                .scaleLinear()
                                                .domain(
                                                    d3.extent(
                                                        data,
                                                        function (d) {
                                                            return d.year;
                                                        }
                                                    )
                                                )
                                                .range([0, width]);
                                            svg.append("g")
                                                .attr(
                                                    "transform",
                                                    "translate(0, " +
                                                        height * 0.8 +
                                                        ")"
                                                )
                                                .call(
                                                    d3
                                                        .axisBottom(x)
                                                        .tickSize(-height * 0.7)
                                                        .tickValues([
                                                            1900, 1925, 1975,
                                                            2000,
                                                        ])
                                                )
                                                .select(".domain")
                                                .remove();

                                            svg.selectAll(".tick line").attr(
                                                "stroke",
                                                "#b8b8b8"
                                            );

                                            svg.append("text")
                                                .attr("text-anchor", "end")
                                                .attr("x", width)
                                                .attr("y", height - 30)
                                                .text("Year");

                                            var y = d3
                                                .scaleLinear()
                                                .domain([-100000, 100000])
                                                .range([height, 0]);

                                            var color = d3
                                                .scaleOrdinal()
                                                .domain(keys)
                                                .range(d3.schemeCategory20b);

                                            //stack the data
                                            var stackData = d3
                                                .stack()
                                                .offset(
                                                    d3.stackOffsetSilhouette
                                                )
                                                .keys(keys)(data);

                                            //toop tip
                                            var Tooltip = svg
                                                .append("text")
                                                .attr("x", 0)
                                                .attr("y", 0)
                                                .style("opacity", 0)
                                                .style("font-size", 17);

                                            //interactions
                                            const mouseover = function (d) {
                                                Tooltip.style("opacity", 1);
                                                d3.selectAll(".myArea").style(
                                                    "opacity",
                                                    0.2
                                                );
                                                d3.select(this)
                                                    .style("stroke", "black")
                                                    .style("opacity", 1);
                                            };

                                            const mousemove = function (d, i) {
                                                grp = keys[i];
                                                Tooltip.text(grp);
                                            };

                                            const mouseleave = function (d) {
                                                Tooltip.style("opacity", 0);
                                                d3.selectAll(".myArea")
                                                    .style("opacity", 1)
                                                    .style("stroke", "none");
                                            };

                                            // area generator
                                            const area = d3
                                                .area()
                                                .x(function (d) {
                                                    return x(d.data.year);
                                                })
                                                .y0(function (d) {
                                                    return y(d[0]);
                                                })
                                                .y1(function (d) {
                                                    return y(d[1]);
                                                });

                                            //show the area
                                            svg.selectAll("mylayers")
                                                .data(stackData)
                                                .enter()
                                                .append("path")
                                                .attr("class", "myArea")
                                                .style("fill", function (d) {
                                                    return color(d.key);
                                                })
                                                .attr("d", area)
                                                .on("mouseover", mouseover)
                                                .on("mousemove", mousemove)
                                                .on("mouseleave", mouseleave);
                                        }
                                    );
                                </script>
                            </div>
                            <div class="titles">
                                <h2>GHG Emissions Density by Country</h2>
                            </div>
                        </div>
                        <div class="sunburst_container">
                            <div class="sunburst_card">
                                <svg id="sunburst"></svg>
                                <div
                                    class="infobox"
                                    style="
                                        visibility: hidden;
                                        flex-direction: row;
                                        display: flex;
                                        justify-content: center;
                                    "
                                >
                                    <p class="title">place</p>
                                    <p>
                                        <strong class="words"> </strong>
                                    </p>
                                </div>
                            </div>
                            <div class="titles">
                                <h2>GHG Emissions by Economic Country</h2>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </main>

        <!--=============== FOOTER ===============-->
        <footer class="footer section">
            <p class="footer__copy">
                Team Members: Anna Mola, Christina Chance, Amin El Asery
            </p>
        </footer>

        <!--------------- Scroll reveal --------------->
        <script src="https://unpkg.com/scrollreveal"></script>

        <!--------------- Main JS --------------->
        <script src="assets/js/main.js"></script>
        s
    </body>
</html>
